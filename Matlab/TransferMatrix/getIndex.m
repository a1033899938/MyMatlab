function varargout = getIndex(varargin)
% material refractive index data downloaded from http://www.filmetrics.com/
%https://refractiveindex.info/
%function：根据材料和对应波长，从网站上获取的数据获取相应的折射率
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%若输入
%material：材料名
%lambda0：真空波长
%则返回
%nr：折射率实部向量
%ni：折射率虚部向量
%errorTag：若超出输入波长超出范围，则返回1

%若多输入一个参数
%则只返回一个ndata
%% 获取折射率
if nargin == 2 || nargin == 3
    material = varargin{1};
    lambda0 = varargin{2};
else
    disp('error INPUT;getIndex()');
end
hc = 1241.25;
eV=hc/lambda0;
errorTag = 0;
ni = 0; 
    
switch (material)
    case {'WSe2ML'}
        % 感兴趣的能量位置
        E1 = eV;
        % 背景介电常数，一般为10左右
        E0 = 3.68^2;
        % 定义的激子能量
        Ex = 1.76;
        % 定义的激子线宽
        Lx = 0.0037;
        % 激子的振子强度,单位eV
        fx = 0.9;
        % 相对介电常数计算
        epsilon_r = E0 + fx/(Ex^2 - E1^2 -1j*Lx*E1);
        % 折射率计算
        n = sqrt(epsilon_r);
        nr = real(n);
        ni = imag(n);
    case {'WS2ML'}
        % 感兴趣的波长位置
        E1 = eV;
        % 背景介电常数，一般为10左右
        E0 = 3.68^2;
        % 定义的激子能量
        Ex = 1240/616.363;
        % 定义的激子线宽
        % Lx = 0.0037;
        Lx = 0.0529;%瞎设的
        % 激子的振子强度,单位eV
        % fx = 0.9;
        fx = 0.9;%瞎设的
        % 相对介电常数计算
        epsilon_r = E0 + fx/(Ex^2 - E1^2 -1j*Lx*E1);
        % 折射率计算
        n = sqrt(epsilon_r);
        nr = real(n);
        ni = imag(n);
    case {'WS2BL'}
        % 感兴趣的波长位置
        E1 = eV;
        % 背景介电常数，一般为10左右
        E0 = 3.68^2;
        % 定义的激子能量
        Ex1 = 1240/632.954775129070;
        Ex2 = 1240/703.486999939289;
        % 定义的激子线宽
        % Lx = 0.0037;
        Lx1 = 0.0781;%瞎设的
        Lx2 = 0.1717;%瞎设的
        % 激子的振子强度,单位eV
        % fx = 0.9;
        fx1 = 4;%瞎设的
        fx2 = 4*1.3927;%瞎设的
        % 相对介电常数计算
        epsilon_r = E0 + fx1/(Ex1^2 - E1^2 -1j*Lx1*E1) + fx2/(Ex2^2 - E1^2 -1j*Lx2*E1);
        % 折射率计算
        n = sqrt(epsilon_r);
        nr = real(n);
        ni = imag(n);
    case {'PMMA'}
        nr = 1.75;
        errorTag = 0;
    case {'Air'}
        %Vakuum
        nVakuum=1;
        nr=nVakuum;
        errorTag = 0;
    case {'Ag'}
        ndata=[...
            310,2.4791,0.0024413
            310.21,2.4778,0.0024476
            310.42,2.4765,0.0024539
            310.63,2.4751,0.0024602
            310.84,2.4738,0.0024665
            311.05,2.4724,0.0024729
            311.26,2.4711,0.0024793
            311.47,2.4698,0.0024857
            311.68,2.4684,0.0024921
            311.9,2.4671,0.0024986
            312.11,2.4657,0.002505
            312.32,2.4643,0.0025115
            312.53,2.463,0.0025181
            312.75,2.4616,0.0025246
            312.96,2.4602,0.0025312
            313.17,2.4589,0.0025378
            313.39,2.4575,0.0025444
            313.6,2.4561,0.0025511
            313.82,2.4547,0.0025578
            314.03,2.4533,0.0025645
            314.25,2.452,0.0025712
            314.46,2.4506,0.002578
            314.68,2.4492,0.0025847
            314.89,2.4478,0.0025916
            315.11,2.4463,0.0025984
            315.33,2.4449,0.0026052
            315.54,2.4435,0.0026121
            315.76,2.4421,0.0026191
            315.98,2.4407,0.002626
            316.2,2.4393,0.002633
            316.41,2.4378,0.00264
            316.63,2.4364,0.002647
            316.85,2.435,0.002654
            317.07,2.4335,0.0026611
            317.29,2.4321,0.0026682
            317.51,2.4306,0.0026754
            317.73,2.4292,0.0026825
            317.95,2.4277,0.0026897
            318.17,2.4263,0.0026969
            318.39,2.4248,0.0027042
            318.61,2.4233,0.0027115
            318.83,2.4219,0.0027188
            319.05,2.4204,0.0027261
            319.28,2.4189,0.0027335
            319.5,2.4174,0.0027409
            319.72,2.4159,0.0027483
            319.94,2.4144,0.0027558
            320.17,2.413,0.0027632
            320.39,2.4115,0.0027708
            320.61,2.4099,0.0027783
            320.84,2.4084,0.0027859
            321.06,2.4069,0.0027935
            321.29,2.4054,0.0028011
            321.51,2.4039,0.0028088
            321.74,2.4024,0.0028165
            321.96,2.4008,0.0028242
            322.19,2.3993,0.002832
            322.42,2.3978,0.0028398
            322.64,2.3962,0.0028476
            322.87,2.3947,0.0028555
            323.1,2.3931,0.0028633
            323.33,2.3916,0.0028713
            323.55,2.39,0.0028792
            323.78,2.3885,0.0028872
            324.01,2.3869,0.0028952
            324.24,2.3853,0.0029033
            324.47,2.3837,0.0029114
            324.7,2.3822,0.0029195
            324.93,2.3806,0.0029276
            325.16,2.379,0.0029358
            325.39,2.3774,0.0029441
            325.62,2.3758,0.0029523
            325.85,2.3742,0.0029606
            326.08,2.3726,0.0029689
            326.32,2.371,0.0029773
            326.55,2.3694,0.0029857
            326.78,2.3677,0.0029941
            327.01,2.3661,0.0030026
            327.25,2.3645,0.0030111
            327.48,2.3629,0.0030196
            327.71,2.3612,0.0030282
            327.95,2.3596,0.0030368
            328.18,2.3579,0.0030455
            328.42,2.3563,0.0030541
            328.65,2.3546,0.0030629
            328.89,2.353,0.0030716
            329.12,2.3513,0.0030804
            329.36,2.3496,0.0030893
            329.6,2.3479,0.0030981
            329.83,2.3463,0.003107
            330.07,2.3446,0.003116
            330.31,2.3429,0.003125
            330.55,2.3412,0.003134
            330.79,2.3395,0.0031431
            331.02,2.3378,0.0031522
            331.26,2.3361,0.0031613
            331.5,2.3344,0.0031705
            331.74,2.3326,0.0031797
            331.98,2.3309,0.003189
            332.22,2.3292,0.0031983
            332.46,2.3274,0.0032077
            332.7,2.3257,0.0032171
            332.95,2.324,0.0032265
            333.19,2.3222,0.003236
            333.43,2.3204,0.0032455
            333.67,2.3187,0.003255
            333.92,2.3169,0.0032646
            334.16,2.3152,0.0032743
            334.4,2.3134,0.003284
            334.65,2.3116,0.0032937
            334.89,2.3098,0.0033035
            335.14,2.308,0.0033133
            335.38,2.3062,0.0033231
            335.63,2.3044,0.003333
            335.87,2.3026,0.003343
            336.12,2.3008,0.003353
            336.36,2.299,0.003363
            336.61,2.2971,0.0033731
            336.86,2.2953,0.0033832
            337.11,2.2935,0.0033934
            337.35,2.2916,0.0034036
            337.6,2.2898,0.0034139
            337.85,2.2879,0.0034242
            338.1,2.2861,0.0034346
            338.35,2.2842,0.003445
            338.6,2.2823,0.0034555
            338.85,2.2805,0.003466
            339.1,2.2786,0.0034765
            339.35,2.2767,0.0034871
            339.6,2.2748,0.0034978
            339.85,2.2729,0.0035085
            340.1,2.271,0.0035193
            340.36,2.2691,0.0035301
            340.61,2.2672,0.0035409
            340.86,2.2653,0.0035518
            341.12,2.2633,0.0035628
            341.37,2.2614,0.0035738
            341.62,2.2595,0.0035849
            341.88,2.2575,0.003596
            342.13,2.2556,0.0036072
            342.39,2.2536,0.0036184
            342.64,2.2516,0.0036297
            342.9,2.2497,0.003641
            343.16,2.2477,0.0036524
            343.41,2.2457,0.0036638
            343.67,2.2437,0.0036753
            343.93,2.2417,0.0036869
            344.19,2.2397,0.0036985
            344.44,2.2377,0.0037101
            344.7,2.2357,0.0037218
            344.96,2.2337,0.0037336
            345.22,2.2317,0.0037454
            345.48,2.2296,0.0037573
            345.74,2.2276,0.0037693
            346,2.2255,0.0037813
            346.26,2.2235,0.0037934
            346.53,2.2214,0.0038055
            346.79,2.2194,0.0038177
            347.05,2.2173,0.0038299
            347.31,2.2152,0.0038422
            347.58,2.2131,0.0038546
            347.84,2.211,0.003867
            348.1,2.2089,0.0038795
            348.37,2.2068,0.0038921
            348.63,2.2047,0.0039047
            348.9,2.2026,0.0039174
            349.16,2.2005,0.0039301
            349.43,2.1983,0.0039429
            349.7,2.1962,0.0039558
            349.96,2.194,0.0039687
            350.23,2.1919,0.0039817
            350.5,2.1897,0.0039948
            350.76,2.1876,0.0040079
            351.03,2.1854,0.0040211
            351.3,2.1832,0.0040344
            351.57,2.181,0.0040478
            351.84,2.1788,0.0040612
            352.11,2.1766,0.0040747
            352.38,2.1744,0.0040882
            352.65,2.1722,0.0041018
            352.92,2.17,0.0041155
            353.19,2.1677,0.0041293
            353.47,2.1655,0.0041431
            353.74,2.1632,0.004157
            354.01,2.161,0.004171
            354.29,2.1587,0.0041851
            354.56,2.1564,0.0041992
            354.83,2.1542,0.0042134
            355.11,2.1519,0.0042277
            355.38,2.1496,0.004242
            355.66,2.1473,0.0042565
            355.93,2.145,0.004271
            356.21,2.1426,0.0042856
            356.49,2.1403,0.0043002
            356.77,2.138,0.004315
            357.04,2.1356,0.0043298
            357.32,2.1333,0.0043447
            357.6,2.1309,0.0043597
            357.88,2.1286,0.0043747
            358.16,2.1262,0.0043899
            358.44,2.1238,0.0044051
            358.72,2.1214,0.0044204
            359,2.119,0.0044359
            359.28,2.1166,0.0044513
            359.56,2.1142,0.0044669
            359.84,2.1118,0.0044826
            360.13,2.1093,0.0044983
            360.41,2.1069,0.0045142
            360.69,2.1044,0.0045301
            360.98,2.102,0.0045461
            361.26,2.0995,0.0045622
            361.54,2.097,0.0045784
            361.83,2.0946,0.0045947
            362.12,2.0921,0.0046111
            362.4,2.0896,0.0046275
            362.69,2.087,0.0046441
            362.97,2.0845,0.0046608
            363.26,2.082,0.0046775
            363.55,2.0795,0.0046944
            363.84,2.0769,0.0047113
            364.13,2.0744,0.0047284
            364.42,2.0718,0.0047455
            364.71,2.0692,0.0047628
            365,2.0666,0.0047801
            365.29,2.064,0.0047976
            365.58,2.0614,0.0048151
            365.87,2.0588,0.0048328
            366.16,2.0562,0.0048505
            366.45,2.0536,0.0048684
            366.75,2.0509,0.0048864
            367.04,2.0483,0.0049045
            367.33,2.0456,0.0049226
            367.63,2.0429,0.0049409
            367.92,2.0402,0.0049593
            368.22,2.0375,0.0049779
            368.51,2.0348,0.0049965
            368.81,2.0321,0.0050152
            369.11,2.0294,0.0050341
            369.4,2.0267,0.0050531
            369.7,2.0239,0.0050722
            370,2.0212,0.0050914
            370.3,2.0184,0.0051107
            370.6,2.0156,0.0051301
            370.9,2.0129,0.0051497
            371.2,2.0101,0.0051694
            371.5,2.0073,0.0051892
            371.8,2.0044,0.0052092
            372.1,2.0016,0.0052292
            372.4,1.9988,0.0052494
            372.71,1.9959,0.0052697
            373.01,1.9931,0.0052902
            373.31,1.9902,0.0053107
            373.62,1.9873,0.0053315
            373.92,1.9844,0.0053523
            374.23,1.9815,0.0053733
            374.53,1.9786,0.0053944
            374.84,1.9757,0.0054156
            375.14,1.9727,0.005437
            375.45,1.9698,0.0054586
            375.76,1.9668,0.0054802
            376.07,1.9638,0.005502
            376.37,1.9608,0.005524
            376.68,1.9578,0.0055461
            376.99,1.9548,0.0055683
            377.3,1.9518,0.0055907
            377.61,1.9488,0.0056133
            377.92,1.9457,0.005636
            378.24,1.9427,0.0056588
            378.55,1.9396,0.0056818
            378.86,1.9365,0.005705
            379.17,1.9334,0.0057283
            379.49,1.9303,0.0057518
            379.8,1.9272,0.0057754
            380.12,1.924,0.0057992
            380.43,1.9209,0.0058232
            380.75,1.9177,0.0058473
            381.06,1.9145,0.0058716
            381.38,1.9114,0.0058961
            381.7,1.9082,0.0059208
            382.01,1.9049,0.0059456
            382.33,1.9017,0.0059706
            382.65,1.8985,0.0059957
            382.97,1.8952,0.0060211
            383.29,1.8919,0.0060466
            383.61,1.8887,0.0060724
            383.93,1.8854,0.0060983
            384.25,1.8821,0.0061244
            384.58,1.8787,0.0061506
            384.9,1.8754,0.0061771
            385.22,1.872,0.0062038
            385.55,1.8687,0.0062306
            385.87,1.8653,0.0062577
            386.2,1.8619,0.006285
            386.52,1.8585,0.0063124
            386.85,1.855,0.0063401
            387.17,1.8516,0.006368
            387.5,1.8481,0.0063961
            387.83,1.8447,0.0064244
            388.16,1.8412,0.0064529
            388.48,1.8377,0.0064817
            388.81,1.8342,0.0065106
            389.14,1.8306,0.0065398
            389.47,1.8271,0.0065692
            389.8,1.8235,0.0065989
            390.14,1.8199,0.0066288
            390.47,1.8163,0.0066589
            390.8,1.8127,0.0066892
            391.13,1.8091,0.0067198
            391.47,1.8054,0.0067506
            391.8,1.8017,0.0067817
            392.14,1.7981,0.0068131
            392.47,1.7944,0.0068446
            392.81,1.7906,0.0068765
            393.14,1.7869,0.0069086
            393.48,1.7832,0.006941
            393.82,1.7794,0.0069736
            394.16,1.7756,0.0070065
            394.5,1.7718,0.0070397
            394.84,1.768,0.0070731
            395.18,1.7641,0.0071069
            395.52,1.7603,0.0071409
            395.86,1.7564,0.0071752
            396.2,1.7525,0.0072098
            396.54,1.7486,0.0072447
            396.89,1.7446,0.0072799
            397.23,1.7407,0.0073154
            397.57,1.7367,0.0073512
            397.92,1.7327,0.0073873
            398.26,1.7287,0.0074238
            398.61,1.7247,0.0074606
            398.96,1.7206,0.0074977
            399.3,1.7165,0.0075351
            399.65,1.7125,0.0075729
            400,1.7083,0.007611
            400.35,1.7042,0.0076494
            400.7,1.7001,0.0076882
            401.05,1.6959,0.0077274
            401.4,1.6917,0.0077669
            401.75,1.6875,0.0078068
            402.1,1.6832,0.0078471
            402.46,1.679,0.0078877
            402.81,1.6747,0.0079288
            403.16,1.6704,0.0079702
            403.52,1.666,0.008012
            403.87,1.6617,0.0080542
            404.23,1.6573,0.0080968
            404.59,1.6529,0.0081399
            404.94,1.6485,0.0081834
            405.3,1.644,0.0082272
            405.66,1.6396,0.0082716
            406.02,1.6351,0.0083164
            406.38,1.6305,0.0083616
            406.74,1.626,0.0084073
            407.1,1.6214,0.0084534
            407.46,1.6168,0.0085
            407.82,1.6122,0.0085471
            408.19,1.6076,0.0085947
            408.55,1.6029,0.0086428
            408.91,1.5982,0.0086914
            409.28,1.5935,0.0087405
            409.64,1.5887,0.0087902
            410.01,1.584,0.0088403
            410.38,1.5792,0.008891
            410.74,1.5743,0.0089423
            411.11,1.5695,0.0089941
            411.48,1.5646,0.0090465
            411.85,1.5597,0.0090995
            412.22,1.5547,0.0091531
            412.59,1.5497,0.0092072
            412.96,1.5447,0.009262
            413.33,1.5397,0.0093174
            413.71,1.5346,0.0093735
            414.08,1.5296,0.0094302
            414.45,1.5244,0.0094876
            414.83,1.5193,0.0095456
            415.2,1.5141,0.0096044
            415.58,1.5089,0.0096638
            415.96,1.5036,0.009724
            416.33,1.4983,0.0097848
            416.71,1.493,0.0098465
            417.09,1.4877,0.0099089
            417.47,1.4823,0.0099721
            417.85,1.4768,0.010036
            418.23,1.4714,0.010101
            418.61,1.4659,0.010166
            419,1.4604,0.010233
            419.38,1.4548,0.0103
            419.76,1.4492,0.010368
            420.15,1.4436,0.010438
            420.53,1.4379,0.010508
            420.92,1.4322,0.010579
            421.3,1.4264,0.01065
            421.69,1.4206,0.010723
            422.08,1.4148,0.010797
            422.47,1.4089,0.010872
            422.86,1.403,0.010948
            423.25,1.3971,0.011025
            423.64,1.3911,0.011104
            424.03,1.385,0.011183
            424.42,1.379,0.011264
            424.81,1.3728,0.011345
            425.21,1.3667,0.011428
            425.6,1.3605,0.011512
            426,1.3542,0.011598
            426.39,1.3479,0.011685
            426.79,1.3415,0.011773
            427.19,1.3351,0.011862
            427.59,1.3287,0.011953
            427.99,1.3222,0.012046
            428.38,1.3156,0.01214
            428.79,1.309,0.012235
            429.19,1.3024,0.012332
            429.59,1.2957,0.012431
            429.99,1.2889,0.012531
            430.39,1.2821,0.012633
            430.8,1.2752,0.012737
            431.2,1.2683,0.012843
            431.61,1.2613,0.012951
            432.02,1.2542,0.01306
            432.42,1.2471,0.013172
            432.83,1.24,0.013285
            433.24,1.2327,0.013401
            433.65,1.2254,0.013519
            434.06,1.2181,0.01364
            434.47,1.2107,0.013762
            434.88,1.2032,0.013887
            435.29,1.1956,0.014015
            435.71,1.188,0.014145
            436.12,1.1803,0.014278
            436.54,1.1725,0.014414
            436.95,1.1647,0.014552
            437.37,1.1567,0.014694
            437.79,1.1487,0.014839
            438.2,1.1407,0.014987
            438.62,1.1325,0.015138
            439.04,1.1243,0.015293
            439.46,1.1159,0.015451
            439.88,1.1075,0.015613
            440.31,1.099,0.01578
            440.73,1.0904,0.01595
            441.15,1.0817,0.016124
            441.58,1.073,0.016303
            442,1.0641,0.016487
            442.43,1.0551,0.016675
            442.86,1.046,0.016869
            443.29,1.0368,0.017068
            443.71,1.0275,0.017272
            444.14,1.0181,0.017483
            444.57,1.0086,0.017699
            445,0.99892,0.017922
            445.44,0.98915,0.018152
            445.87,0.97926,0.018389
            446.3,0.96923,0.018634
            446.74,0.95907,0.018886
            447.17,0.94877,0.019147
            447.61,0.93833,0.019417
            448.05,0.92774,0.019696
            448.48,0.91699,0.019985
            448.92,0.90609,0.020285
            449.36,0.89502,0.020597
            449.8,0.88378,0.02092
            450.25,0.87236,0.021256
            450.69,0.86075,0.021606
            451.13,0.84896,0.021971
            451.57,0.83696,0.022352
            452.02,0.82475,0.02275
            452.47,0.81232,0.023167
            452.91,0.79966,0.023603
            453.36,0.78676,0.024061
            453.81,0.77361,0.024543
            454.26,0.76019,0.02505
            454.71,0.74649,0.025586
            455.16,0.73249,0.026153
            455.61,0.71818,0.026753
            456.06,0.70354,0.027392
            456.52,0.68854,0.028072
            456.97,0.67316,0.028799
            457.43,0.65738,0.029579
            457.88,0.64117,0.030418
            458.34,0.62449,0.031324
            458.8,0.6073,0.032307
            459.26,0.58957,0.033379
            459.72,0.57123,0.034554
            460.18,0.55224,0.03585
            460.64,0.53253,0.037289
            461.11,0.51201,0.0389
            461.57,0.4906,0.040721
            462.03,0.46816,0.042802
            462.5,0.44456,0.04521
            462.97,0.41962,0.048042
            463.43,0.39312,0.051437
            463.9,0.36474,0.055607
            464.37,0.33412,0.060887
            464.84,0.30075,0.067849
            465.31,0.26403,0.077522
            465.79,0.22344,0.091882
            466.26,0.17978,0.11455
            466.73,0.13834,0.14931
            467.21,0.10752,0.1927
            467.69,0.087976,0.23623
            468.16,0.07546,0.27625
            468.64,0.066889,0.31261
            469.12,0.060643,0.34587
            469.6,0.055864,0.37661
            470.08,0.05207,0.40529
            470.56,0.048971,0.43227
            471.05,0.046382,0.4578
            471.53,0.044179,0.48211
            472.02,0.042277,0.50536
            472.5,0.040614,0.52768
            472.99,0.039145,0.54917
            473.48,0.037836,0.56993
            473.97,0.036661,0.59004
            474.46,0.035597,0.60954
            474.95,0.03463,0.62851
            475.44,0.033746,0.64699
            475.93,0.032934,0.66501
            476.43,0.032185,0.68262
            476.92,0.031491,0.69983
            477.42,0.030846,0.71669
            477.92,0.030245,0.73322
            478.42,0.029683,0.74943
            478.91,0.029157,0.76535
            479.41,0.028663,0.781
            479.92,0.028197,0.79639
            480.42,0.027758,0.81153
            480.92,0.027343,0.82645
            481.43,0.02695,0.84114
            481.93,0.026577,0.85563
            482.44,0.026223,0.86993
            482.95,0.025886,0.88404
            483.46,0.025565,0.89797
            483.97,0.025259,0.91173
            484.48,0.024966,0.92533
            484.99,0.024687,0.93877
            485.5,0.02442,0.95207
            486.02,0.024163,0.96523
            486.53,0.023918,0.97825
            487.05,0.023682,0.99114
            487.57,0.023455,1.0039
            488.09,0.023238,1.0166
            488.6,0.023028,1.0291
            489.13,0.022826,1.0415
            489.65,0.022632,1.0538
            490.17,0.022444,1.066
            490.7,0.022264,1.0781
            491.22,0.022089,1.0901
            491.75,0.02192,1.1021
            492.27,0.021758,1.1139
            492.8,0.0216,1.1256
            493.33,0.021448,1.1373
            493.86,0.0213,1.1489
            494.4,0.021157,1.1604
            494.93,0.021019,1.1718
            495.46,0.020885,1.1832
            496,0.020755,1.1944
            496.54,0.020628,1.2056
            497.07,0.020506,1.2168
            497.61,0.020387,1.2279
            498.15,0.020272,1.2389
            498.7,0.02016,1.2498
            499.24,0.020051,1.2607
            499.78,0.019945,1.2716
            500.33,0.019842,1.2823
            500.87,0.019742,1.2931
            501.42,0.019645,1.3037
            501.97,0.01955,1.3144
            502.52,0.019458,1.3249
            503.07,0.019368,1.3354
            503.62,0.019281,1.3459
            504.18,0.019196,1.3563
            504.73,0.019113,1.3667
            505.29,0.019032,1.377
            505.84,0.018954,1.3873
            506.4,0.018877,1.3976
            506.96,0.018803,1.4078
            507.52,0.01873,1.418
            508.08,0.018659,1.4281
            508.65,0.01859,1.4382
            509.21,0.018522,1.4482
            509.78,0.018456,1.4583
            510.34,0.018392,1.4682
            510.91,0.018329,1.4782
            511.48,0.018268,1.4881
            512.05,0.018208,1.498
            512.63,0.01815,1.5078
            513.2,0.018093,1.5177
            513.77,0.018038,1.5274
            514.35,0.017984,1.5372
            514.93,0.017931,1.5469
            515.51,0.017879,1.5566
            516.09,0.017829,1.5663
            516.67,0.017779,1.576
            517.25,0.017731,1.5856
            517.83,0.017684,1.5952
            518.42,0.017639,1.6047
            519,0.017594,1.6143
            519.59,0.01755,1.6238
            520.18,0.017508,1.6333
            520.77,0.017466,1.6428
            521.36,0.017425,1.6522
            521.96,0.017386,1.6617
            522.55,0.017347,1.6711
            523.15,0.017309,1.6805
            523.74,0.017272,1.6898
            524.34,0.017236,1.6992
            524.94,0.017201,1.7085
            525.54,0.017166,1.7178
            526.15,0.017133,1.7271
            526.75,0.0171,1.7364
            527.36,0.017068,1.7457
            527.96,0.017037,1.7549
            528.57,0.017006,1.7641
            529.18,0.016977,1.7733
            529.79,0.016948,1.7825
            530.4,0.01692,1.7917
            531.02,0.016892,1.8009
            531.63,0.016865,1.81
            532.25,0.016839,1.8191
            532.87,0.016813,1.8282
            533.49,0.016789,1.8374
            534.11,0.016764,1.8464
            534.73,0.016741,1.8555
            535.36,0.016718,1.8646
            535.98,0.016695,1.8736
            536.61,0.016673,1.8827
            537.24,0.016652,1.8917
            537.87,0.016632,1.9007
            538.5,0.016612,1.9097
            539.13,0.016592,1.9187
            539.76,0.016573,1.9277
            540.4,0.016555,1.9367
            541.04,0.016537,1.9457
            541.68,0.016519,1.9546
            542.32,0.016502,1.9636
            542.96,0.016486,1.9725
            543.6,0.01647,1.9814
            544.25,0.016455,1.9903
            544.89,0.01644,1.9993
            545.54,0.016425,2.0082
            546.19,0.016411,2.0171
            546.84,0.016398,2.026
            547.49,0.016385,2.0348
            548.15,0.016372,2.0437
            548.8,0.01636,2.0526
            549.46,0.016348,2.0614
            550.12,0.016337,2.0703
            550.78,0.016326,2.0791
            551.44,0.016316,2.088
            552.11,0.016306,2.0968
            552.77,0.016296,2.1057
            553.44,0.016287,2.1145
            554.11,0.016278,2.1233
            554.78,0.016269,2.1321
            555.45,0.016261,2.1409
            556.12,0.016254,2.1498
            556.8,0.016246,2.1586
            557.47,0.016239,2.1674
            558.15,0.016233,2.1762
            558.83,0.016227,2.185
            559.51,0.016221,2.1937
            560.2,0.016215,2.2025
            560.88,0.01621,2.2113
            561.57,0.016205,2.2201
            562.25,0.016201,2.2289
            562.94,0.016197,2.2377
            563.64,0.016193,2.2464
            564.33,0.01619,2.2552
            565.02,0.016187,2.264
            565.72,0.016184,2.2728
            566.42,0.016182,2.2815
            567.12,0.016179,2.2903
            567.82,0.016178,2.2991
            568.53,0.016176,2.3078
            569.23,0.016175,2.3166
            569.94,0.016174,2.3254
            570.65,0.016174,2.3341
            571.36,0.016173,2.3429
            572.07,0.016174,2.3516
            572.78,0.016174,2.3604
            573.5,0.016175,2.3692
            574.22,0.016176,2.3779
            574.94,0.016177,2.3867
            575.66,0.016178,2.3955
            576.38,0.01618,2.4042
            577.11,0.016182,2.413
            577.83,0.016185,2.4218
            578.56,0.016187,2.4305
            579.29,0.01619,2.4393
            580.03,0.016194,2.4481
            580.76,0.016197,2.4569
            581.5,0.016201,2.4657
            582.23,0.016205,2.4744
            582.97,0.016209,2.4832
            583.72,0.016214,2.492
            584.46,0.016219,2.5008
            585.2,0.016224,2.5096
            585.95,0.016229,2.5184
            586.7,0.016235,2.5272
            587.45,0.016241,2.536
            588.21,0.016247,2.5448
            588.96,0.016253,2.5536
            589.72,0.01626,2.5624
            590.48,0.016267,2.5712
            591.24,0.016274,2.58
            592,0.016281,2.5888
            592.76,0.016289,2.5977
            593.53,0.016297,2.6065
            594.3,0.016305,2.6153
            595.07,0.016313,2.6242
            595.84,0.016322,2.633
            596.62,0.016331,2.6418
            597.4,0.01634,2.6507
            598.17,0.016349,2.6596
            598.96,0.016359,2.6684
            599.74,0.016369,2.6773
            600.52,0.016379,2.6862
            601.31,0.016389,2.695
            602.1,0.0164,2.7039
            602.89,0.016411,2.7128
            603.68,0.016422,2.7217
            604.48,0.016433,2.7306
            605.28,0.016444,2.7395
            606.08,0.016456,2.7484
            606.88,0.016468,2.7574
            607.68,0.01648,2.7663
            608.49,0.016493,2.7752
            609.3,0.016505,2.7842
            610.11,0.016518,2.7931
            610.92,0.016531,2.8021
            611.73,0.016544,2.811
            612.55,0.016558,2.82
            613.37,0.016572,2.829
            614.19,0.016586,2.8379
            615.01,0.0166,2.8469
            615.84,0.016614,2.8559
            616.67,0.016629,2.8649
            617.5,0.016644,2.874
            618.33,0.016659,2.883
            619.16,0.016674,2.892
            620,0.01669,2.9011
            620.84,0.016705,2.9101
            621.68,0.016721,2.9192
            622.52,0.016738,2.9282
            623.37,0.016754,2.9373
            624.22,0.016771,2.9464
            625.07,0.016787,2.9555
            625.92,0.016804,2.9646
            626.78,0.016822,2.9737
            627.63,0.016839,2.9828
            628.49,0.016857,2.9919
            629.36,0.016875,3.0011
            630.22,0.016893,3.0102
            631.09,0.016911,3.0194
            631.96,0.01693,3.0286
            632.83,0.016949,3.0377
            633.7,0.016968,3.0469
            634.58,0.016987,3.0561
            635.46,0.017006,3.0653
            636.34,0.017026,3.0746
            637.22,0.017046,3.0838
            638.11,0.017066,3.093
            639,0.017086,3.1023
            639.89,0.017107,3.1115
            640.78,0.017127,3.1208
            641.68,0.017148,3.1301
            642.58,0.017169,3.1394
            643.48,0.017191,3.1487
            644.38,0.017212,3.158
            645.29,0.017234,3.1674
            646.2,0.017256,3.1767
            647.11,0.017278,3.1861
            648.02,0.017301,3.1954
            648.94,0.017323,3.2048
            649.86,0.017346,3.2142
            650.78,0.017369,3.2236
            651.7,0.017393,3.233
            652.63,0.017416,3.2425
            653.56,0.01744,3.2519
            654.49,0.017464,3.2614
            655.43,0.017488,3.2708
            656.37,0.017512,3.2803
            657.31,0.017537,3.2898
            658.25,0.017562,3.2993
            659.2,0.017587,3.3089
            660.14,0.017612,3.3184
            661.1,0.017638,3.3279
            662.05,0.017663,3.3375
            663.01,0.017689,3.3471
            663.97,0.017715,3.3567
            664.93,0.017742,3.3663
            665.89,0.017768,3.3759
            666.86,0.017795,3.3855
            667.83,0.017822,3.3952
            668.8,0.017849,3.4049
            669.78,0.017877,3.4145
            670.76,0.017905,3.4242
            671.74,0.017932,3.4339
            672.73,0.017961,3.4437
            673.72,0.017989,3.4534
            674.71,0.018018,3.4632
            675.7,0.018046,3.4729
            676.7,0.018075,3.4827
            677.7,0.018105,3.4925
            678.7,0.018134,3.5023
            679.7,0.018164,3.5122
            680.71,0.018194,3.522
            681.72,0.018224,3.5319
            682.74,0.018254,3.5418
            683.76,0.018285,3.5517
            684.78,0.018316,3.5616
            685.8,0.018347,3.5715
            686.83,0.018378,3.5815
            687.86,0.01841,3.5915
            688.89,0.018442,3.6014
            689.92,0.018474,3.6114
            690.96,0.018506,3.6215
            692.01,0.018538,3.6315
            693.05,0.018571,3.6416
            694.1,0.018604,3.6516
            695.15,0.018637,3.6617
            696.21,0.018671,3.6718
            697.26,0.018704,3.682
            698.33,0.018738,3.6921
            699.39,0.018772,3.7023
            700.46,0.018807,3.7124
            701.53,0.018841,3.7226
            702.6,0.018876,3.7329
            703.68,0.018911,3.7431
            704.76,0.018947,3.7534
            705.85,0.018982,3.7636
            706.93,0.019018,3.7739
            708.02,0.019054,3.7842
            709.12,0.019091,3.7946
            710.22,0.019127,3.8049
            711.32,0.019164,3.8153
            712.42,0.019201,3.8257
            713.53,0.019238,3.8361
            714.64,0.019276,3.8466
            715.76,0.019314,3.857
            716.88,0.019352,3.8675
            718,0.01939,3.878
            719.12,0.019429,3.8885
            720.25,0.019468,3.899
            721.38,0.019507,3.9096
            722.52,0.019546,3.9202
            723.66,0.019586,3.9308
            724.8,0.019626,3.9414
            725.95,0.019666,3.9521
            727.1,0.019707,3.9627
            728.25,0.019747,3.9734
            729.41,0.019788,3.9841
            730.57,0.01983,3.9949
            731.74,0.019871,4.0056
            732.91,0.019913,4.0164
            734.08,0.019955,4.0272
            735.26,0.019997,4.038
            736.44,0.02004,4.0489
            737.62,0.020083,4.0597
            738.81,0.020126,4.0706
            740,0.020169,4.0816
            741.2,0.020213,4.0925
            742.39,0.020257,4.1035
            743.6,0.020301,4.1145
            744.81,0.020346,4.1255
            746.02,0.020391,4.1365
            747.23,0.020436,4.1476
            748.45,0.020481,4.1587
            749.67,0.020527,4.1698
            750.9,0.020573,4.1809
            752.13,0.020619,4.1921
            753.37,0.020666,4.2032
            754.61,0.020713,4.2145
            755.85,0.02076,4.2257
            757.1,0.020808,4.237
            758.35,0.020855,4.2482
            759.6,0.020903,4.2596
            760.86,0.020952,4.2709
            762.13,0.021,4.2823
            763.39,0.021049,4.2937
            764.67,0.021099,4.3051
            765.94,0.021148,4.3165
            767.22,0.021198,4.328
            768.51,0.021249,4.3395
            769.8,0.021299,4.351
            771.09,0.02135,4.3626
            772.39,0.021401,4.3742
            773.69,0.021453,4.3858
            775,0.021504,4.3974
            776.31,0.021557,4.4091
            777.63,0.021609,4.4208
            778.95,0.021662,4.4325
            780.27,0.021715,4.4443
            781.6,0.021768,4.456
            782.94,0.021822,4.4678
            784.27,0.021876,4.4797
            785.62,0.021931,4.4916
            786.96,0.021986,4.5035
            788.32,0.022041,4.5154
            789.67,0.022096,4.5273
            791.03,0.022152,4.5393
            792.4,0.022208,4.5514
            793.77,0.022265,4.5634
            795.15,0.022322,4.5755
            796.53,0.022379,4.5876
            797.91,0.022436,4.5997
            799.3,0.022494,4.6119
            800.7,0.022553,4.6241
            802.1,0.022611,4.6364
            803.5,0.02267,4.6486
            804.91,0.02273,4.6609
            806.33,0.022789,4.6733
            807.75,0.02285,4.6856
            809.17,0.02291,4.698
            810.6,0.022971,4.7105
            812.04,0.023032,4.7229
            813.48,0.023094,4.7354
            814.92,0.023156,4.7479
            816.37,0.023218,4.7605
            817.83,0.023281,4.7731
            819.29,0.023344,4.7857
            820.75,0.023408,4.7984
            822.22,0.023472,4.8111
            823.7,0.023536,4.8238
            825.18,0.023601,4.8366
            826.67,0.023666,4.8494
            828.16,0.023731,4.8623
            829.66,0.023797,4.8751
            831.16,0.023864,4.8881
            832.67,0.02393,4.901
            834.18,0.023998,4.914
            835.7,0.024065,4.927
            837.23,0.024133,4.9401
            838.76,0.024202,4.9532
            840.29,0.02427,4.9663
            841.83,0.02434,4.9795
            843.38,0.024409,4.9927
            844.94,0.02448,5.0059
            846.49,0.02455,5.0192
            848.06,0.024621,5.0325
            849.63,0.024693,5.0459
            851.21,0.024765,5.0593
            852.79,0.024837,5.0727
            854.38,0.02491,5.0862
            855.97,0.024983,5.0997
            857.57,0.025057,5.1133
            859.18,0.025131,5.1269
            860.79,0.025206,5.1405
            862.41,0.025281,5.1542
            864.03,0.025356,5.1679
            865.66,0.025432,5.1817
            867.3,0.025509,5.1955
            868.94,0.025586,5.2093
            870.59,0.025664,5.2232
            872.24,0.025742,5.2372
            873.9,0.02582,5.2511
            875.57,0.025899,5.2651
            877.25,0.025979,5.2792
            878.93,0.026059,5.2933
            880.61,0.026139,5.3074
            882.31,0.02622,5.3216
            884.01,0.026302,5.3358
            885.71,0.026384,5.3501
            887.43,0.026466,5.3644
            889.15,0.026549,5.3788
            890.87,0.026633,5.3932
            892.61,0.026717,5.4077
            894.35,0.026802,5.4222
            896.09,0.026887,5.4367
            897.85,0.026973,5.4513
            899.61,0.027059,5.466
            901.38,0.027146,5.4806
            903.15,0.027233,5.4954
            904.93,0.027321,5.5102
            906.72,0.02741,5.525
            908.51,0.027499,5.5399
            910.32,0.027588,5.5548
            912.13,0.027679,5.5698
            913.94,0.02777,5.5848
            915.77,0.027861,5.5999
            917.6,0.027953,5.615
            919.44,0.028046,5.6301
            921.29,0.028139,5.6454
            923.14,0.028233,5.6606
            925,0.028327,5.676
            926.87,0.028422,5.6913
            928.74,0.028518,5.7068
            930.63,0.028614,5.7223
            932.52,0.028711,5.7378
            934.42,0.028808,5.7534
            936.33,0.028906,5.769
            938.24,0.029005,5.7847
            940.16,0.029105,5.8004
            942.09,0.029205,5.8162
            944.03,0.029306,5.8321
            945.98,0.029407,5.848
            947.93,0.029509,5.864
            949.9,0.029612,5.88
            951.87,0.029715,5.8961
            953.85,0.029819,5.9122];

            wavelengths_in_base = ndata(:,1);
            nr_in_base = ndata(:,2);
            ni_in_base = ndata(:,3);
            wavelengths_in_base_min = wavelengths_in_base(1);
            wavelengths_in_base_max = wavelengths_in_base(end);
            if lambda0<wavelengths_in_base_min
                %如果输入的波长超出了库中的波长最小值，则返回库中的波长最小值对应的折射率
                disp('Warning: out of refraction data range.');
                
                nr = ndata(1,2);
                ni = ndata(1,3);
                errorTag = 1;
            elseif lambda0>wavelengths_in_base_max
                %如果输入的波长超出了库中的波长最大值，则返回库中的波长最大值对应的折射率
                    disp('Warning: out of refraction data range.');
                    
                    nr = ndata(end,2);
                    ni = ndata(end,3);
                    errorTag = 1;
            else
                %如果输入的波长在库中的波长范围中，则用线性插值法返回与输入波长最近的两个折射率的平均值
                nr = interp1(wavelengths_in_base,nr_in_base,lambda0,'linear');%线性插值%interp1(x,y,newx,'method')：原来以xy为横纵坐标向量的曲线，现在在以newx为横坐标，对原曲线进行插值，返回得到的newy向量
                ni = interp1(wavelengths_in_base,ni_in_base,lambda0,'linear');
            end
            if nargin >= 3
                varargout{1} = ndata;
            end
    case {'Si'}
        ndata=[...
            206.6	1.010 	2.909
            210.1	1.083 	2.982
            213.8	1.133 	3.045
            217.5	1.186 	3.12
            221.4	1.247 	3.206
            225.4	1.340 	3.302
            229.6	1.471 	3.366
            233.9	1.579 	3.353
            238.4	1.589 	3.354
            243.1	1.571 	3.429
            248	1.570 	3.565
            253	1.597 	3.749
            258.3	1.658 	3.979
            263.8	1.764 	4.278
            269.5	1.988 	4.678
            275.5	2.452 	5.082
            281.8	3.120 	5.344
            288.3	4.087 	5.395
            295.2	4.888 	4.639
            302.4	5.020 	3.979
            310	5.010 	3.586
            317.9	5.016 	3.346
            326.3	5.065 	3.182
            335.1	5.156 	3.058
            344.4	5.296 	2.987
            354.2	5.610 	3.014
            364.7	6.522 	2.705
            375.7	6.709 	1.32
            387.5	6.062 	0.63
            399.9	5.570 	0.387
            413.3	5.222 	0.269
            427.5	4.961 	0.203
            442.8	4.753 	0.163
            459.2	4.583 	0.13
            476.9	4.442 	0.09
            495.9	4.320 	0.073
            516.6	4.215 	0.06
            539.1	4.123 	0.048
            563.6	4.042 	0.032
            590.4	3.969 	0.03
            619.9	3.906 	0.022
            652.5	3.847 	0.016
            688.8	3.796 	0.013
            729.3	3.752 	0.01
            774.9	3.714 	0.008
            826.6	3.673 	0.005];

            wavelengths_in_base = ndata(:,1);
            nr_in_base = ndata(:,2);
            ni_in_base = ndata(:,3);
            wavelengths_in_base_min = wavelengths_in_base(1);
            wavelengths_in_base_max = wavelengths_in_base(end);
            if lambda0<wavelengths_in_base_min
                %如果输入的波长超出了库中的波长最小值，则返回库中的波长最小值对应的折射率
                disp('Warning: out of refraction data range.');
                
                nr = ndata(1,2);
                ni = ndata(1,3);
                errorTag = 1;
            elseif lambda0>wavelengths_in_base_max
                %如果输入的波长超出了库中的波长最大值，则返回库中的波长最大值对应的折射率
                    disp('Warning: out of refraction data range.');
                    
                    nr = ndata(end,2);
                    ni = ndata(end,3);
                    errorTag = 1;
            else
                %如果输入的波长在库中的波长范围中，则用线性插值法返回与输入波长最近的两个折射率的平均值
                nr = interp1(wavelengths_in_base,nr_in_base,lambda0,'linear');%线性插值%interp1(x,y,newx,'method')：原来以xy为横纵坐标向量的曲线，现在在以newx为横坐标，对原曲线进行插值，返回得到的newy向量
                ni = interp1(wavelengths_in_base,ni_in_base,lambda0,'linear');
            end
            if nargin >= 3
                varargout{1} = ndata;
            end
    case {'SiO2'}
        ndata=[...
            260	1.502 	0
            274	1.496 	0
            289	1.491 	0
            303	1.487 	0
            318	1.483 	0
            332	1.480 	0
            346	1.477 	0
            361	1.475 	0
            375	1.473 	0
            390	1.471 	0
            404	1.470 	0
            418	1.468 	0
            433	1.467 	0
            447	1.466 	0
            462	1.465 	0
            476	1.464 	0
            490	1.463 	0
            505	1.462 	0
            519	1.461 	0
            534	1.461 	0
            548	1.460 	0
            562	1.459 	0
            577	1.459 	0
            591	1.458 	0
            606	1.458 	0
            620	1.457 	0
            634	1.457 	0
            649	1.457 	0
            663	1.456 	0
            678	1.456 	0
            692	1.456 	0
            706	1.455 	0
            721	1.455 	0
            735	1.455 	0
            750	1.454 	0
            764	1.454 	0
            778	1.454 	0
            793	1.453 	0
            807	1.453 	0
            822	1.453 	0
            836	1.453 	0
            850	1.453 	0
            865	1.452 	0
            879	1.452 	0
            894	1.452 	0
            908	1.452 	0];
            
            wavelengths_in_base = ndata(:,1);
            nr_in_base = ndata(:,2);
            ni_in_base = ndata(:,3);
            wavelengths_in_base_min = wavelengths_in_base(1);
            wavelengths_in_base_max = wavelengths_in_base(end);
            if lambda0<wavelengths_in_base_min
                %如果输入的波长超出了库中的波长最小值，则返回库中的波长最小值对应的折射率
                disp('Warning: out of refraction data range.');
                
                nr = ndata(1,2);
                ni = ndata(1,3);
                errorTag = 1;
            elseif lambda0>wavelengths_in_base_max
                %如果输入的波长超出了库中的波长最大值，则返回库中的波长最大值对应的折射率
                    disp('Warning: out of refraction data range.');
                    
                    nr = ndata(end,2);
                    ni = ndata(end,3);
                    errorTag = 1;
            else
                %如果输入的波长在库中的波长范围中，则用线性插值法返回与输入波长最近的两个折射率的平均值
                nr = interp1(wavelengths_in_base,nr_in_base,lambda0,'linear');%线性插值%interp1(x,y,newx,'method')：原来以xy为横纵坐标向量的曲线，现在在以newx为横坐标，对原曲线进行插值，返回得到的newy向量
                ni = interp1(wavelengths_in_base,ni_in_base,lambda0,'linear');
            end
            if nargin >= 3
                varargout{1} = ndata;
            end
    case {'GaAs'}
        %GaAs
        ndata=[...
            206.63	1.264	2.472
            210.14	1.288	2.557
            213.76	1.311	2.625
            217.51	1.325	2.71
            221.39	1.349	2.815
            225.42	1.383	2.936
            229.59	1.43	3.079
            233.92	1.499	3.255
            238.42	1.599	3.484
            243.1		1.802	3.795
            247.96	2.273	4.084
            253.02	2.89	4.047
            258.29	3.342	3.77
            263.79	3.598	3.452
            269.52	3.769	3.169
            275.51	3.913	2.919
            281.77	4.015	2.563
            288.33	3.939	2.26
            295.19	3.81	2.069
            302.39	3.692	1.969
            309.95	3.601	1.92
            317.9		3.538	1.904
            326.26	3.501	1.909
            335.08	3.485	1.931
            344.39	3.495	1.965
            354.23	3.531	2.013
            364.65	3.596	2.076
            375.7		3.709	2.162
            387.44	3.938	2.288
            399.94	4.373	2.146
            413.27	4.509	1.948
            427.52	5.052	1.721
            442.79	4.959	0.991
            459.19	4.694	0.696
            476.85	4.492	0.539
            495.92	4.333	0.441
            516.58	4.205	0.371
            539.04	4.1	0.32
            563.55	4.013	0.276
            590.38	3.94	0.24
            619.9		3.878	0.211
            652.53	3.826	0.179
            688.78	3.785	0.151
            729.29	3.742	0.112
            774.87	3.7	0.091
            826.53	3.666	0.08
            885.57	3.614	0.0017
            953.69	3.5388	0
            1033.17	3.492	0
            1127.09	3.4546	0
            1239.8	3.4232	0
            1377.56	3.3965	0
            1549.75	3.3737	0
            1771.14	3.3543	0
            2066.33	3.3378	0];

            wavelengths_in_base = ndata(:,1);
            nr_in_base = ndata(:,2);
            ni_in_base = ndata(:,3);
            wavelengths_in_base_min = wavelengths_in_base(1);
            wavelengths_in_base_max = wavelengths_in_base(end);
            if lambda0<wavelengths_in_base_min
                %如果输入的波长超出了库中的波长最小值，则返回库中的波长最小值对应的折射率
                disp('Warning: out of refraction data range.');
                
                nr = ndata(1,2);
                ni = ndata(1,3);
                errorTag = 1;
            elseif lambda0>wavelengths_in_base_max
                %如果输入的波长超出了库中的波长最大值，则返回库中的波长最大值对应的折射率
                    disp('Warning: out of refraction data range.');
                    
                    nr = ndata(end,2);
                    ni = ndata(end,3);
                    errorTag = 1;
            else
                %如果输入的波长在库中的波长范围中，则用线性插值法返回与输入波长最近的两个折射率的平均值
                nr = interp1(wavelengths_in_base,nr_in_base,lambda0,'linear');%线性插值%interp1(x,y,newx,'method')：原来以xy为横纵坐标向量的曲线，现在在以newx为横坐标，对原曲线进行插值，返回得到的newy向量
                ni = interp1(wavelengths_in_base,ni_in_base,lambda0,'linear');
            end
            if nargin >= 3
                varargout{1} = ndata;
            end
    case {'GaN'}
        %GaN
        ndata=[...
	        203.28	2.804	1.233 
	        210.17	2.813	1.095 
	        217.54	2.817	0.976 
	        225.45	2.808	0.856 
	        233.96	2.787	0.74 
	        243.14	2.764	0.63 
	        253.06	2.722	0.544 
	        263.83	2.674	0.479 
	        275.56	2.629	0.43 
	        288.37	2.597	0.402 
	        302.44	2.572	0.376 
	        317.95	2.555	0.361 
	        335.14	2.56	0.349 
	        354.29	2.615	0.339 
	        364.71	2.716	0.261 
	        370.15	2.664	0.167 
	        375.76	2.675	0 
	        400	2.565	0 
	        427.59	2.51	0 
	        459.26	2.471	0 
	        496	2.436	0 
	        539.13	2.408	0 
	        590.48	2.393	0 
	        620	2.383	0 
	        688.89	2.365	0 
	        729.41	2.359	0 
	        775	2.351	0 
	        826.67	2.346	0 
	        885.71	2.34	0 
	        953.85	2.336	0 
	        2480	2.264	0.0001 
	        3100	2.255	0.0002];
            
            wavelengths_in_base = ndata(:,1);
            nr_in_base = ndata(:,2);
            ni_in_base = ndata(:,3);
            wavelengths_in_base_min = wavelengths_in_base(1);
            wavelengths_in_base_max = wavelengths_in_base(end);
            if lambda0<wavelengths_in_base_min
                %如果输入的波长超出了库中的波长最小值，则返回库中的波长最小值对应的折射率
                disp('Warning: out of refraction data range.');
                
                nr = ndata(1,2);
                ni = ndata(1,3);
                errorTag = 1;
            elseif lambda0>wavelengths_in_base_max
                %如果输入的波长超出了库中的波长最大值，则返回库中的波长最大值对应的折射率
                    disp('Warning: out of refraction data range.');
                    
                    nr = ndata(end,2);
                    ni = ndata(end,3);
                    errorTag = 1;
            else
                %如果输入的波长在库中的波长范围中，则用线性插值法返回与输入波长最近的两个折射率的平均值
                nr = interp1(wavelengths_in_base,nr_in_base,lambda0,'linear');%线性插值%interp1(x,y,newx,'method')：原来以xy为横纵坐标向量的曲线，现在在以newx为横坐标，对原曲线进行插值，返回得到的newy向量
                ni = interp1(wavelengths_in_base,ni_in_base,lambda0,'linear');
            end 
            if nargin >= 3
                varargout{1} = ndata;
            end
    case {'AlAs'}
        %AlAs
        ndata=[...
            221		1.32093	2.430308
            221.43	1.36	2.75
            223.42	1.3706	2.8063
            225.45	1.36	2.89
            227.52	1.3494	2.9963
            229.63	1.36	3.12
            231.78	1.43	3.2588
            233.96	1.53	3.4
            236.19	1.6363	3.5294
            238.46	1.77	3.65
            240.78	1.96	3.765
            243.14	2.16	3.86
            245.54	2.3169	3.9125
            248		2.48	3.95
            250.51	2.685	4.0019
            253.06	2.92	4.04
            255.67	3.1975	4.0556
            258.33	3.48	4.02
            261.05	3.7388	3.8969
            263.83	3.96	3.7
            266.67	4.1225	3.4038
            269.57	4.22	3.09
            272.53	4.225	2.8288
            275.56	4.18	2.63
            278.65	4.1094	2.5463
            281.82	4.04	2.52
            285.06	4.01	2.5063
            288.37	4.01	2.52
            291.76	4.0356	2.5719
            295.24	4.11	2.63
            298.8		4.2681	2.6738
            302.44	4.47	2.68
            306.17	4.6906	2.6094
            310		4.92	2.49
            313.92	5.1606	2.3613
            317.95	5.35	2.15
            322.08	5.4219	1.738
            326.32	5.39	1.3
            330.67	5.2094	0.9874
            335.14	4.99	0.752
            339.73	4.845	0.6128
            344.44	4.72	0.519
            349.3		4.5944	0.4183
            354.29	4.48	0.334
            359.42	4.3856	0.2778
            364.71	4.3	0.233
            370.15	4.2163	0.1812
            375.76	4.13	0.139
            381.54	4.0294	0.1213
            387.5		3.93	0.115
            393.65	3.845	0.1132
            400		3.77	0.113
            406.56	3.7052	0.1107
            413.33	3.6493	0.1024
            420.34	3.6013	0.0804
            427.59	3.5603	0.053
            435.09	3.5253	0.0234
            442.86	3.4955	0
            450.91	3.4699	0.0033
            459.26	3.4475	0
            467.92	3.4274	0
            476.92	3.4088	0
            486.27	3.3905	0
            496		3.3718	0
            506.12	3.3516	0
            516.67	3.329	0
            527.66	3.3013	0
            539.13	3.273	0
            551.11	3.2481	0
            563.64	3.225	0
            576.74	3.2034	0
            590.48	3.183	0
            604.88	3.1634	0
            620		3.145	0
            635.9		3.128	0
            652.63	3.112	0
            670.27	3.0966	0
            688.89	3.082	0
            708.57	3.0686	0
            729.41	3.056	0
            751.52	3.0438	0
            775		3.032	0
            800		3.0208	0
            826.67	3.01	0
            855.17	2.9997	0
            885.71	2.99	0
            918.52	2.9813	0
            953.85	2.973	0
            992		2.9648	0
            1033.33	2.957	0
            1078.26	2.9498	0
            1127.27	2.943	0
            1180.95	2.9363	0
            1240		2.93	0
            1305.26	2.9243	0
            1377.78	2.919	0
            1458.82	2.9138	0
            1550		2.909	0
            1653.33	2.9048	0
            1771.43	2.901	0
            1907.69	2.8974	0
            2066.67	2.894	0
            2254.55	2.8909	0
            2480		2.888	0];

            wavelengths_in_base = ndata(:,1);
            nr_in_base = ndata(:,2);
            ni_in_base = ndata(:,3);
            wavelengths_in_base_min = wavelengths_in_base(1);
            wavelengths_in_base_max = wavelengths_in_base(end);
            if lambda0<wavelengths_in_base_min
                %如果输入的波长超出了库中的波长最小值，则返回库中的波长最小值对应的折射率
                disp('Warning: out of refraction data range.');
                
                nr = ndata(1,2);
                ni = ndata(1,3);
                errorTag = 1;
            elseif lambda0>wavelengths_in_base_max
                %如果输入的波长超出了库中的波长最大值，则返回库中的波长最大值对应的折射率
                    disp('Warning: out of refraction data range.');
                    
                    nr = ndata(end,2);
                    ni = ndata(end,3);
                    errorTag = 1;
            else
                %如果输入的波长在库中的波长范围中，则用线性插值法返回与输入波长最近的两个折射率的平均值
                nr = interp1(wavelengths_in_base,nr_in_base,lambda0,'linear');%线性插值%interp1(x,y,newx,'method')：原来以xy为横纵坐标向量的曲线，现在在以newx为横坐标，对原曲线进行插值，返回得到的newy向量
                ni = interp1(wavelengths_in_base,ni_in_base,lambda0,'linear');
            end
            if nargin >= 3
                varargout{1} = ndata;
            end
    case {'Al(0.1)GaAs'}
        ndata=[...
            206.7	1.311	2.457
            210.2	1.318	2.538
            213.8	1.33	2.608
            217.5	1.345	2.698
            221.4	1.371	2.8
            225.5	1.408	2.921
            229.6	1.459	3.059
            234	1.531	3.223
            238.5	1.634	3.433
            243.1	1.819	3.704
            248	2.207	3.983
            253.1	2.772	4.036
            258.3	3.267	3.846
            263.8	3.611	3.536
            270	3.829	3.229
            275.6	4.01	2.876
            281.8	4.017	2.507
            288.4	3.922	2.24
            295.2	3.801	2.074
            302.4	3.697	1.983
            310	3.618	1.937
            317.9	3.566	1.92
            326.3	3.537	1.924
            335.1	3.532	1.945
            344.4	3.552	1.979
            354.3	3.601	2.03
            364.7	3.69	2.1
            375.8	3.864	2.203
            387.5	4.253	2.187
            400	4.46	1.949
            413.3	4.838	1.836
            427.6	4.968	1.126
            442.9	4.725	0.763
            459.3	4.518	0.575
            476.9	4.353	0.462
            496	4.22	0.382
            516.7	4.111	0.32
            539.1	4.018	0.276
            563.6	3.94	0.237
            590.5	3.876	0.199
            620	3.82	0.171
            652.6	3.775	0.127
            688.9	3.716	0.099
            729.4	3.678	0.082
            775	3.661	0.059
            826.7	3.572	0
            885.7	3.53	0
            953.8	3.484	0
            1033.3	3.452	0
            1127.3	3.428	0
            1240	3.41	0
            1377.8	3.395	0
            1550	3.383	0
            1771.4	3.374	0
            2066.7	3.366	0];

            wavelengths_in_base = ndata(:,1);
            nr_in_base = ndata(:,2);
            ni_in_base = ndata(:,3);
            wavelengths_in_base_min = wavelengths_in_base(1);
            wavelengths_in_base_max = wavelengths_in_base(end);
            if lambda0<wavelengths_in_base_min
                %如果输入的波长超出了库中的波长最小值，则返回库中的波长最小值对应的折射率
                disp('Warning: out of refraction data range.');
                
                nr = ndata(1,2);
                ni = ndata(1,3);
                errorTag = 1;
            elseif lambda0>wavelengths_in_base_max
                %如果输入的波长超出了库中的波长最大值，则返回库中的波长最大值对应的折射率
                    disp('Warning: out of refraction data range.');
                    
                    nr = ndata(end,2);
                    ni = ndata(end,3);
                    errorTag = 1;
            else
                %如果输入的波长在库中的波长范围中，则用线性插值法返回与输入波长最近的两个折射率的平均值
                nr = interp1(wavelengths_in_base,nr_in_base,lambda0,'linear');%线性插值%interp1(x,y,newx,'method')：原来以xy为横纵坐标向量的曲线，现在在以newx为横坐标，对原曲线进行插值，返回得到的newy向量
                ni = interp1(wavelengths_in_base,ni_in_base,lambda0,'linear');
            end
            if nargin >= 3
                varargout{1} = ndata;
            end
    case {'Al(0.2)GaAs'}
        ndata=[...
            206.7	1.333	2.457
            210.2	1.339	2.531
            213.8	1.349	2.6
            217.5	1.366	2.688
            221.4	1.393	2.794
            225.5	1.433	2.912
            229.6	1.49	3.049
            234	1.567	3.208
            238.5	1.677	3.407
            243.1	1.86	3.654
            248	2.21	3.914
            253.1	2.734	3.997
            258.3	3.238	3.867
            263.8	3.638	3.575
            270	3.924	3.223
            275.6	4.053	2.803
            281.8	4.018	2.449
            288.4	3.911	2.206
            295.2	3.795	2.059
            302.4	3.701	1.976
            310	3.633	1.933
            317.9	3.588	1.917
            326.3	3.568	1.922
            335.1	3.572	1.942
            344.4	3.602	1.979
            354.3	3.668	2.034
            364.7	3.792	2.115
            375.8	4.084	2.18
            387.5	4.379	1.978
            400	4.607	1.857
            413.3	4.943	1.322
            427.6	4.757	0.865
            442.9	4.547	0.636
            459.3	4.375	0.5
            476.9	4.235	0.409
            496	4.118	0.341
            516.7	4.022	0.288
            539.1	3.94	0.242
            563.6	3.871	0.202
            590.5	3.815	0.165
            620	3.759	0.118
            652.6	3.7	0.094
            688.9	3.662	0.082
            729.4	3.635	0.02
            775	3.536	0.002
            826.7	3.457	0
            885.7	3.465	0
            953.8	3.429	0
            1033.3	3.401	0
            1127.3	3.379	0
            1240	3.361	0
            1377.8	3.346	0
            1550	3.334	0
            1771.4	3.324	0
            2066.7	3.316	0];

            wavelengths_in_base = ndata(:,1);
            nr_in_base = ndata(:,2);
            ni_in_base = ndata(:,3);
            wavelengths_in_base_min = wavelengths_in_base(1);
            wavelengths_in_base_max = wavelengths_in_base(end);
            if lambda0<wavelengths_in_base_min
                %如果输入的波长超出了库中的波长最小值，则返回库中的波长最小值对应的折射率
                disp('Warning: out of refraction data range.');
                
                nr = ndata(1,2);
                ni = ndata(1,3);
                errorTag = 1;
            elseif lambda0>wavelengths_in_base_max
                %如果输入的波长超出了库中的波长最大值，则返回库中的波长最大值对应的折射率
                    disp('Warning: out of refraction data range.');
                    
                    nr = ndata(end,2);
                    ni = ndata(end,3);
                    errorTag = 1;
            else
                %如果输入的波长在库中的波长范围中，则用线性插值法返回与输入波长最近的两个折射率的平均值
                nr = interp1(wavelengths_in_base,nr_in_base,lambda0,'linear');%线性插值%interp1(x,y,newx,'method')：原来以xy为横纵坐标向量的曲线，现在在以newx为横坐标，对原曲线进行插值，返回得到的newy向量
                ni = interp1(wavelengths_in_base,ni_in_base,lambda0,'linear');
            end   
            if nargin >= 3
                varargout{1} = ndata;
            end
    case {'Al(0.8)GaAs'}
        ndata=[...
            206.7	1.368	2.409
            210.2	1.36	2.473
            213.8	1.354	2.56
            217.5	1.37	2.667
            221.4	1.399	2.792
            225.5	1.447	2.935
            229.6	1.528	3.104
            234	1.661	3.293
            238.5	1.857	3.475
            243.1	2.11	3.635
            248	2.426	3.763
            253.1	2.833	3.815
            258.3	3.233	3.765
            263.8	3.751	3.582
            270	4.107	3.128
            275.6	4.112	2.639
            281.8	4.004	2.389
            288.4	3.928	2.256
            295.2	3.893	2.183
            302.4	3.904	2.144
            310	3.962	2.119
            317.9	4.078	2.092
            326.3	4.267	2.013
            335.1	4.462	1.82
            344.4	4.613	1.561
            354.3	4.667	1.199
            364.7	4.562	0.89
            375.8	4.413	0.685
            387.5	4.277	0.541
            400	4.155	0.437
            413.3	4.05	0.353
            427.6	3.961	0.276
            442.9	3.872	0.205
            459.3	3.787	0.161
            476.9	3.738	0.104
            496	3.635	0.013
            516.7	3.519	0.004
            539.1	3.44	0.003
            563.6	3.378	0
            590.5	3.322	0
            620	3.277	0
            652.6	3.236	0
            688.9	3.202	0
            729.4	3.173	0
            775	3.147	0
            826.7	3.124	0
            885.7	3.103	0
            953.8	3.083	0
            1033.3	3.065	0
            1127.3	3.049	0
            1240	3.035	0
            1377.8	3.022	0
            1550	3.012	0
            1771.4	3.003	0
            2066.7	2.995	0];

            wavelengths_in_base = ndata(:,1);
            nr_in_base = ndata(:,2);
            ni_in_base = ndata(:,3);
            wavelengths_in_base_min = wavelengths_in_base(1);
            wavelengths_in_base_max = wavelengths_in_base(end);
            if lambda0<wavelengths_in_base_min
                %如果输入的波长超出了库中的波长最小值，则返回库中的波长最小值对应的折射率
                disp('Warning: out of refraction data range.');
                
                nr = ndata(1,2);
                ni = ndata(1,3);
                errorTag = 1;
            elseif lambda0>wavelengths_in_base_max
                %如果输入的波长超出了库中的波长最大值，则返回库中的波长最大值对应的折射率
                    disp('Warning: out of refraction data range.');
                    
                    nr = ndata(end,2);
                    ni = ndata(end,3);
                    errorTag = 1;
            else
                %如果输入的波长在库中的波长范围中，则用线性插值法返回与输入波长最近的两个折射率的平均值
                nr = interp1(wavelengths_in_base,nr_in_base,lambda0,'linear');%线性插值%interp1(x,y,newx,'method')：原来以xy为横纵坐标向量的曲线，现在在以newx为横坐标，对原曲线进行插值，返回得到的newy向量
                ni = interp1(wavelengths_in_base,ni_in_base,lambda0,'linear');
            end   
            if nargin >= 3
                varargout{1} = ndata;
            end
    case {'Al(0.9)GaAs'}
        ndata=[...
            459.3	3.807	0
            476.9	3.637	0
            496	3.524	0
            516.7	3.438	0
            539.1	3.369	0
            563.6	3.312	0
            590.5	3.263	0
            620	3.221	0
            652.6	3.183	0
            688.9	3.151	0
            729.4	3.122	0
            775	3.096	0
            826.7	3.073	0
            885.7	3.052	0
            953.8	3.033	0
            1033.3	3.017	0
            1127.3	3.002	0
            1240	2.989	0
            1377.8	2.977	0
            1550	2.967	0
            1771.4	2.959	0
            2066.7	2.951	0];
        
            wavelengths_in_base = ndata(:,1);
            nr_in_base = ndata(:,2);
            ni_in_base = ndata(:,3);
            wavelengths_in_base_min = wavelengths_in_base(1);
            wavelengths_in_base_max = wavelengths_in_base(end);
            if lambda0<wavelengths_in_base_min
                %如果输入的波长超出了库中的波长最小值，则返回库中的波长最小值对应的折射率
                disp('Warning: out of refraction data range.');
                
                nr = ndata(1,2);
                ni = ndata(1,3);
            elseif lambda0>wavelengths_in_base_max
                %如果输入的波长超出了库中的波长最大值，则返回库中的波长最大值对应的折射率
                    disp('Warning: out of refraction data range.');
                    
                    nr = ndata(end,2);
                    ni = ndata(end,3);
            else
                %如果输入的波长在库中的波长范围中，则用线性插值法返回与输入波长最近的两个折射率的平均值
                nr = interp1(wavelengths_in_base,nr_in_base,lambda0,'linear');%线性插值%interp1(x,y,newx,'method')：原来以xy为横纵坐标向量的曲线，现在在以newx为横坐标，对原曲线进行插值，返回得到的newy向量
                ni = interp1(wavelengths_in_base,ni_in_base,lambda0,'linear');
            end  
            if nargin >= 3
                varargout{1} = ndata;
            end
    case {'InGaAs'}
        %InGaAs Quantenpunkte
        nInGaAs=9.2948-13.848*eV+10.75*power(eV,2)-2.6574*power(eV,3);
        nr=nInGaAs;
    case {'Nickel'}
        %Nickel
        nNi=1.4215+1.19567*eV;
        nr=nNi;
    case {'AlGaAs'}
        %AlGaAs 
        nAlGaAs=3.24885+0.19558*eV-0.2201*power(eV,2)+0.13598*power(eV,3);
        nr=nAlGaAs;       
    case{'Al15GaAs'}%Al(0.15)GaAs
        [nrAl10GaAs,niAl10GaAs]=getIndex('Al(0.1)GaAs',lambda0);
        [nrAl20GaAs,niAl20GaAs]=getIndex('Al(0.2)GaAs',lambda0);
        nr=0.5*nrAl10GaAs+0.5*nrAl20GaAs;
    %     [nrAl10GaAs,niAl10GaAs]=getIndex('Al(0.1)GaAs',wavelength+80);
    %     [nrAl20GaAs,niAl20GaAs]=getIndex('Al(0.2)GaAs',wavelength+80);
        ni=0.0*niAl10GaAs+0.0*niAl20GaAs; % Here I average between the data of 10% and 20% AlGaAs.
    case{'Al(0.85)GaAs'}
        [nrAl80GaAs,niAl80GaAs]=getIndex('Al(0.8)GaAs',lambda0);
        [nrAl90GaAs,niAl90GaAs]=getIndex('Al(0.9)GaAs',lambda0);
        nr=0.5*nrAl80GaAs+0.5*nrAl90GaAs;
        ni=0.5*niAl80GaAs+0.5*niAl90GaAs; % The absorption starts from 585nm, so it is simply ZERO since we only consider 600-1000nm
end
if nargin == 2
    varargout{1} = nr;
    varargout{2} = ni;
    varargout{3} = errorTag;
elseif nargin == 3
    varargout{1} = ndata;
else
    disp('error INPUT;getIndex()');
return
end